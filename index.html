<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deutsch Pro ğŸ¤–ğŸ‡©ğŸ‡ª</title>
    <style>
        :root { --de-blue: #0d3d7a; --de-gold: #ffc107; --error: #ef4444; --success: #22c55e; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; color: #1e293b; }
        
        .container { max-width: 500px; width: 100%; background: white; padding: 25px; border-radius: 24px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        h2 { color: var(--de-blue); text-align: center; margin-bottom: 20px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }

        .input-group { background: #f1f5f9; padding: 20px; border-radius: 16px; margin-bottom: 20px; }
        input { padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; width: 100%; box-sizing: border-box; transition: 0.3s; }
        input:focus { border-color: var(--de-blue); outline: none; }
        
        /* Progress Bar */
        .progress-container { width: 100%; height: 8px; background: #e2e8f0; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: var(--success); transition: 0.5s; }

        /* Card Animation */
        .card { width: 100%; height: 280px; perspective: 1000px; cursor: pointer; margin-bottom: 20px; }
        .card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 20px; border: 4px solid var(--de-blue); padding: 30px; box-sizing: border-box; box-shadow: 0 10px 15px rgba(0,0,0,0.05); }
        .card-front { background: white; }
        .card-back { background: var(--de-blue); color: white; transform: rotateY(180deg); }

        .label { font-size: 12px; text-transform: uppercase; color: #94a3b8; margin-bottom: 10px; font-weight: bold; }
        .word { font-size: 32px; font-weight: bold; }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn { padding: 16px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.3s; transform: translateY(0); }
        .btn:active { transform: translateY(2px); }
        .btn-add { background: var(--de-blue); color: white; width: 100%; margin-top: 10px; }
        .btn-wrong { background: #fee2e2; color: var(--error); border: 2px solid var(--error); }
        .btn-right { background: #dcfce7; color: var(--success); border: 2px solid var(--success); }
        
        .utility-btns { margin-top: 25px; display: flex; justify-content: center; gap: 10px; }
        .small-btn { font-size: 11px; padding: 8px 12px; background: #94a3b8; color: white; border-radius: 6px; border: none; cursor: pointer; }

        #loading { font-size: 12px; color: var(--de-blue); display: none; margin-bottom: 10px; font-weight: bold; }
        .hidden { display: none !important; }
    </style>
</head>
<body onload="initApp()">

    <div class="container">
        <h2>Deutsch AI ğŸ¤–</h2>

        <div class="input-group">
            <div id="loading">âœ¨ áƒ•áƒ—áƒáƒ áƒ’áƒ›áƒœáƒ˜...</div>
            <input type="text" id="geo-input" placeholder="áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒáƒ“...">
            <button class="btn btn-add" onclick="translateAndAdd()">áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ</button>
        </div>

        <div id="quiz-section" class="hidden">
            <div class="progress-container"><div id="progress-bar"></div></div>
            
            <div class="card" id="main-card" onclick="this.classList.toggle('flipped')">
                <div class="card-inner">
                    <div class="card-front">
                        <span class="label">GEORGIAN</span>
                        <div class="word" id="display-geo">...</div>
                    </div>
                    <div class="card-back">
                        <span class="label" style="color:#cbd5e1">GERMAN</span>
                        <div class="word" id="display-de">...</div>
                        <button style="margin-top:20px; background:white; border:none; padding:8px 15px; border-radius:20px; cursor:pointer;" onclick="speakWord(event)">ğŸ”Š áƒ›áƒáƒ¡áƒ›áƒ”áƒœáƒ</button>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-wrong" onclick="handleResult(false)">áƒ¨áƒ”áƒ›áƒ”áƒ¨áƒáƒšáƒ</button>
                <button class="btn btn-right" onclick="handleResult(true)">áƒ•áƒ˜áƒªáƒ˜!</button>
            </div>
        </div>

        <div class="utility-btns">
            <button class="small-btn" onclick="exportData()">ğŸ’¾ áƒ¤áƒáƒ˜áƒšáƒáƒ“ áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ</button>
            <button class="small-btn" onclick="document.getElementById('importFile').click()">ğŸ“‚ áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ’áƒáƒ®áƒ¡áƒœáƒ</button>
            <input type="file" id="importFile" class="hidden" onchange="importData(event)">
        </div>
    </div>

    <script>
        let cards = [];
        let currentIndex = 0;

        function initApp() {
            const saved = localStorage.getItem('ai_de_cards_v2');
            if (saved) {
                cards = JSON.parse(saved);
                updateUI();
            }
        }

        async function translateAndAdd() {
            const input = document.getElementById('geo-input');
            const text = input.value.trim();
            if (!text) return;

            document.getElementById('loading').style.display = 'block';

            try {
                const res = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=ka|de`);
                const data = await res.json();
                const translated = data.responseData.translatedText;

                cards.push({ geo: text, de: translated, score: 0 });
                input.value = '';
                saveCards();
                updateUI();
            } catch (err) {
                alert("áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ!");
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function handleResult(isCorrect) {
            if (isCorrect) {
                cards[currentIndex].score += 1;
            } else {
                cards[currentIndex].score = Math.max(0, cards[currentIndex].score - 2);
            }
            
            // áƒ¡áƒáƒ áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ: áƒ áƒ—áƒ£áƒšáƒ˜ áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ”áƒ‘áƒ˜ (áƒ“áƒáƒ‘áƒáƒšáƒ˜ áƒ¥áƒ£áƒšáƒ˜áƒ—) áƒ’áƒáƒ“áƒ›áƒáƒ“áƒ˜áƒ¡ áƒ¬áƒ˜áƒœ
            cards.sort((a, b) => a.score - b.score);
            
            // áƒ’áƒáƒ“áƒáƒ•áƒ“áƒ˜áƒ•áƒáƒ áƒ— áƒ¨áƒ”áƒ›áƒ“áƒ”áƒ’áƒ–áƒ” áƒ›áƒªáƒ˜áƒ áƒ” áƒ áƒ”áƒœáƒ“áƒáƒ›áƒ˜áƒ–áƒáƒªáƒ˜áƒ˜áƒ—
            currentIndex = (currentIndex + 1) % Math.min(cards.length, 5); 
            
            saveCards();
            showCard();
        }

        function showCard() {
            if (cards.length === 0) return;
            const card = cards[currentIndex];
            document.getElementById('display-geo').innerText = card.geo;
            document.getElementById('display-de').innerText = card.de;
            document.getElementById('main-card').classList.remove('flipped');
            
            // áƒáƒ áƒáƒ’áƒ áƒ”áƒ¡áƒ˜ (áƒ›áƒáƒ¥áƒ¡áƒ˜áƒ›áƒáƒšáƒ£áƒ  áƒ¥áƒ£áƒšáƒáƒ“ áƒáƒ•áƒ˜áƒ¦áƒáƒ— 10)
            const totalScore = cards.reduce((sum, c) => sum + Math.min(c.score, 10), 0);
            const percent = (totalScore / (cards.length * 10)) * 100;
            document.getElementById('progress-bar').style.width = percent + '%';
        }

        function updateUI() {
            const quiz = document.getElementById('quiz-section');
            if (cards.length > 0) {
                quiz.classList.remove('hidden');
                showCard();
            }
        }

        function saveCards() { localStorage.setItem('ai_de_cards_v2', JSON.stringify(cards)); }

        function speakWord(e) {
            e.stopPropagation();
            const speech = new SpeechSynthesisUtterance(cards[currentIndex].de);
            speech.lang = 'de-DE';
            window.speechSynthesis.speak(speech);
        }

        // EXPORT/IMPORT áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ”áƒ‘áƒ˜
        function exportData() {
            const dataStr = JSON.stringify(cards);
            const blob = new Blob([dataStr], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = "my_german_words.json";
            link.click();
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    cards = [...cards, ...imported];
                    saveCards();
                    updateUI();
                    alert("áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ”áƒ‘áƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒ“áƒáƒ”áƒ›áƒáƒ¢áƒ!");
                } catch (err) { alert("áƒ¤áƒáƒ˜áƒšáƒ˜ áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜áƒ!"); }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>
